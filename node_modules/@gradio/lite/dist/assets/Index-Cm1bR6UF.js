import{d as ze,i as Ie,e as Me,g as w,B as Ee,h as C,m as P,j as z,k as I,l as S,a9 as Be,a2 as qe,aa as Fe,F as L,y as j,z as k,v as E,a6 as Le,ab as je,G as R,H as T,x as B,Q as Ce,aI as K,Y as Pe,aJ as N,A as q,C as F,aK as ae,ag as oe,E as ue,r as Se,aL as $,V as G,w as Ve,X as Ae}from"../lite.js";import{B as Ge}from"./BlockLabel-BXhHlgLF.js";import{E as He}from"./Empty-DQJy8RTG.js";import{M as Je,a as Ke}from"./Minimize-DIY7_XRY.js";import{I as re}from"./Image-qZS1Nt0l.js";import{r as y}from"./file-url-D8iSvEay.js";function x(t,e,n){const l=t.slice();return l[32]=e[n],l[34]=n,l}function ee(t,e,n){const l=t.slice();return l[32]=e[n],l[34]=n,l}function Ne(t){let e,n,l,i,s,a,m,v,b,d,h=!t[17]&&t[14]&&le(t),_=t[17]&&te(t),M=K(t[15]?t[15]?.annotations:[]),o=[];for(let r=0;r<M.length;r+=1)o[r]=ne(ee(t,M,r));let f=t[6]&&t[15]&&se(t);return{c(){e=j("div"),n=j("div"),h&&h.c(),l=L(),_&&_.c(),i=L(),s=j("img"),m=L();for(let r=0;r<o.length;r+=1)o[r].c();v=L(),f&&f.c(),b=Pe(),k(n,"class","icon-buttons svelte-e56hdz"),k(s,"class","base-image svelte-e56hdz"),N(s.src,a=t[15]?t[15].image.url:null)||k(s,"src",a),k(s,"alt","the base file that is annotated"),q(s,"fit-height",t[7]&&!t[17]),k(e,"class","image-container svelte-e56hdz")},m(r,g){E(r,e,g),F(e,n),h&&h.m(n,null),F(n,l),_&&_.m(n,null),F(e,i),F(e,s),F(e,m);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);t[26](e),E(r,v,g),f&&f.m(r,g),E(r,b,g),d=!0},p(r,g){if(!r[17]&&r[14]?h?(h.p(r,g),g[0]&147456&&z(h,1)):(h=le(r),h.c(),z(h,1),h.m(n,l)):h&&(R(),I(h,1,1,()=>{h=null}),T()),r[17]?_?(_.p(r,g),g[0]&131072&&z(_,1)):(_=te(r),_.c(),z(_,1),_.m(n,null)):_&&(R(),I(_,1,1,()=>{_=null}),T()),(!d||g[0]&32768&&!N(s.src,a=r[15]?r[15].image.url:null))&&k(s,"src",a),(!d||g[0]&131200)&&q(s,"fit-height",r[7]&&!r[17]),g[0]&229904){M=K(r[15]?r[15]?.annotations:[]);let c;for(c=0;c<M.length;c+=1){const V=ee(r,M,c);o[c]?o[c].p(V,g):(o[c]=ne(V),o[c].c(),o[c].m(e,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=M.length}r[6]&&r[15]?f?f.p(r,g):(f=se(r),f.c(),f.m(b.parentNode,b)):f&&(f.d(1),f=null)},i(r){d||(z(h),z(_),d=!0)},o(r){I(h),I(_),d=!1},d(r){r&&(B(e),B(v),B(b)),h&&h.d(),_&&_.d(),ae(o,r),t[26](null),f&&f.d(r)}}}function Qe(t){let e,n;return e=new He({props:{size:"large",unpadded_box:!0,$$slots:{default:[Xe]},$$scope:{ctx:t}}}),{c(){C(e.$$.fragment)},m(l,i){P(e,l,i),n=!0},p(l,i){const s={};i[1]&32&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){n||(z(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function le(t){let e,n;return e=new oe({props:{Icon:Je,label:"View in full screen"}}),e.$on("click",t[19]),{c(){C(e.$$.fragment)},m(l,i){P(e,l,i),n=!0},p:ue,i(l){n||(z(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function te(t){let e,n;return e=new oe({props:{Icon:Ke,label:"Exit full screen"}}),e.$on("click",t[19]),{c(){C(e.$$.fragment)},m(l,i){P(e,l,i),n=!0},p:ue,i(l){n||(z(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function ne(t){let e,n,l,i;return{c(){e=j("img"),k(e,"alt",n="segmentation mask identifying "+t[4]+" within the uploaded file"),k(e,"class","mask fit-height svelte-e56hdz"),N(e.src,l=t[32].image.url)||k(e,"src",l),k(e,"style",i=t[9]&&t[32].label in t[9]?null:`filter: hue-rotate(${Math.round(t[34]*360/t[15]?.annotations.length)}deg);`),q(e,"fit-height",!t[17]),q(e,"active",t[16]==t[32].label),q(e,"inactive",t[16]!=t[32].label&&t[16]!=null)},m(s,a){E(s,e,a)},p(s,a){a[0]&16&&n!==(n="segmentation mask identifying "+s[4]+" within the uploaded file")&&k(e,"alt",n),a[0]&32768&&!N(e.src,l=s[32].image.url)&&k(e,"src",l),a[0]&33280&&i!==(i=s[9]&&s[32].label in s[9]?null:`filter: hue-rotate(${Math.round(s[34]*360/s[15]?.annotations.length)}deg);`)&&k(e,"style",i),a[0]&131072&&q(e,"fit-height",!s[17]),a[0]&98304&&q(e,"active",s[16]==s[32].label),a[0]&98304&&q(e,"inactive",s[16]!=s[32].label&&s[16]!=null)},d(s){s&&B(e)}}}function se(t){let e,n=K(t[15].annotations),l=[];for(let i=0;i<n.length;i+=1)l[i]=ie(x(t,n,i));return{c(){e=j("div");for(let i=0;i<l.length;i+=1)l[i].c();k(e,"class","legend svelte-e56hdz")},m(i,s){E(i,e,s);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(i,s){if(s[0]&7373312){n=K(i[15].annotations);let a;for(a=0;a<n.length;a+=1){const m=x(i,n,a);l[a]?l[a].p(m,s):(l[a]=ie(m),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},d(i){i&&B(e),ae(l,i)}}}function ie(t){let e,n=t[32].label+"",l,i,s,a;function m(){return t[27](t[32])}function v(){return t[28](t[32])}function b(){return t[31](t[34],t[32])}return{c(){e=j("button"),l=Se(n),i=L(),k(e,"class","legend-item svelte-e56hdz"),$(e,"background-color",t[9]&&t[32].label in t[9]?t[9][t[32].label]+"88":`hsla(${Math.round(t[34]*360/t[15].annotations.length)}, 100%, 50%, 0.3)`)},m(d,h){E(d,e,h),F(e,l),F(e,i),s||(a=[G(e,"mouseover",m),G(e,"focus",v),G(e,"mouseout",t[29]),G(e,"blur",t[30]),G(e,"click",b)],s=!0)},p(d,h){t=d,h[0]&32768&&n!==(n=t[32].label+"")&&Ve(l,n),h[0]&33280&&$(e,"background-color",t[9]&&t[32].label in t[9]?t[9][t[32].label]+"88":`hsla(${Math.round(t[34]*360/t[15].annotations.length)}, 100%, 50%, 0.3)`)},d(d){d&&B(e),s=!1,Ae(a)}}}function Xe(t){let e,n;return e=new re({}),{c(){C(e.$$.fragment)},m(l,i){P(e,l,i),n=!0},i(l){n||(z(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function Ye(t){let e,n,l,i,s,a,m,v;const b=[{autoscroll:t[3].autoscroll},{i18n:t[3].i18n},t[13]];let d={};for(let o=0;o<b.length;o+=1)d=qe(d,b[o]);e=new Fe({props:d}),l=new Ge({props:{show_label:t[5],Icon:re,label:t[4]||t[3].i18n("image.image")}});const h=[Qe,Ne],_=[];function M(o,f){return o[15]==null?0:1}return a=M(t),m=_[a]=h[a](t),{c(){C(e.$$.fragment),n=L(),C(l.$$.fragment),i=L(),s=j("div"),m.c(),k(s,"class","container svelte-e56hdz")},m(o,f){P(e,o,f),E(o,n,f),P(l,o,f),E(o,i,f),E(o,s,f),_[a].m(s,null),v=!0},p(o,f){const r=f[0]&8200?Le(b,[f[0]&8&&{autoscroll:o[3].autoscroll},f[0]&8&&{i18n:o[3].i18n},f[0]&8192&&je(o[13])]):{};e.$set(r);const g={};f[0]&32&&(g.show_label=o[5]),f[0]&24&&(g.label=o[4]||o[3].i18n("image.image")),l.$set(g);let c=a;a=M(o),a===c?_[a].p(o,f):(R(),I(_[c],1,1,()=>{_[c]=null}),T(),m=_[a],m?m.p(o,f):(m=_[a]=h[a](o),m.c()),z(m,1),m.m(s,null))},i(o){v||(z(e.$$.fragment,o),z(l.$$.fragment,o),z(m),v=!0)},o(o){I(e.$$.fragment,o),I(l.$$.fragment,o),I(m),v=!1},d(o){o&&(B(n),B(i),B(s)),S(e,o),S(l,o),_[a].d()}}}function De(t){let e,n;return e=new Ee({props:{visible:t[2],elem_id:t[0],elem_classes:t[1],padding:!1,height:t[7],width:t[8],allow_overflow:!1,container:t[10],scale:t[11],min_width:t[12],$$slots:{default:[Ye]},$$scope:{ctx:t}}}),{c(){C(e.$$.fragment)},m(l,i){P(e,l,i),n=!0},p(l,i){const s={};i[0]&4&&(s.visible=l[2]),i[0]&1&&(s.elem_id=l[0]),i[0]&2&&(s.elem_classes=l[1]),i[0]&128&&(s.height=l[7]),i[0]&256&&(s.width=l[8]),i[0]&1024&&(s.container=l[10]),i[0]&2048&&(s.scale=l[11]),i[0]&4096&&(s.min_width=l[12]),i[0]&516856|i[1]&32&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){n||(z(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function Oe(t,e,n){let{elem_id:l=""}=e,{elem_classes:i=[]}=e,{visible:s=!0}=e,{value:a=null}=e,m=null,v=null,{gradio:b}=e,{label:d=b.i18n("annotated_image.annotated_image")}=e,{show_label:h=!0}=e,{show_legend:_=!0}=e,{height:M}=e,{width:o}=e,{color_map:f}=e,{container:r=!0}=e,{scale:g=null}=e,{min_width:c=void 0}=e,V=null,{loading_status:U}=e,{show_fullscreen_button:W=!0}=e,Q=!1,H;Be(()=>{document.addEventListener("fullscreenchange",()=>{n(17,Q=!!document.fullscreenElement)})});const fe=async()=>{Q?await document.exitFullscreen():await H.requestFullscreen()};let X=null;function Y(u){n(16,V=u)}function D(){n(16,V=null)}function Z(u,J){b.dispatch("select",{value:d,index:u})}function _e(u){Ce[u?"unshift":"push"](()=>{H=u,n(18,H)})}const he=u=>Y(u.label),ce=u=>Y(u.label),me=()=>D(),ge=()=>D(),de=(u,J)=>Z(u,J.label);return t.$$set=u=>{"elem_id"in u&&n(0,l=u.elem_id),"elem_classes"in u&&n(1,i=u.elem_classes),"visible"in u&&n(2,s=u.visible),"value"in u&&n(23,a=u.value),"gradio"in u&&n(3,b=u.gradio),"label"in u&&n(4,d=u.label),"show_label"in u&&n(5,h=u.show_label),"show_legend"in u&&n(6,_=u.show_legend),"height"in u&&n(7,M=u.height),"width"in u&&n(8,o=u.width),"color_map"in u&&n(9,f=u.color_map),"container"in u&&n(10,r=u.container),"scale"in u&&n(11,g=u.scale),"min_width"in u&&n(12,c=u.min_width),"loading_status"in u&&n(13,U=u.loading_status),"show_fullscreen_button"in u&&n(14,W=u.show_fullscreen_button)},t.$$.update=()=>{if(t.$$.dirty[0]&58720264)if(a!==m&&(n(24,m=a),b.dispatch("change")),a){const u={image:a.image,annotations:a.annotations.map(A=>({image:A.image,label:A.label}))};n(15,v=u);const J=y(u.image.url),be=Promise.all(u.annotations.map(A=>y(A.image.url))),O=Promise.all([J,be]);n(25,X=O),O.then(([A,we])=>{if(X!==O)return;const ke={image:{...u.image,url:A??void 0},annotations:u.annotations.map((p,ve)=>({...p,image:{...p.image,url:we[ve]??void 0}}))};n(15,v=ke)})}else n(15,v=null)},[l,i,s,b,d,h,_,M,o,f,r,g,c,U,W,v,V,Q,H,fe,Y,D,Z,a,m,X,_e,he,ce,me,ge,de]}class $e extends ze{constructor(e){super(),Ie(this,e,Oe,De,Me,{elem_id:0,elem_classes:1,visible:2,value:23,gradio:3,label:4,show_label:5,show_legend:6,height:7,width:8,color_map:9,container:10,scale:11,min_width:12,loading_status:13,show_fullscreen_button:14},null,[-1,-1])}get elem_id(){return this.$$.ctx[0]}set elem_id(e){this.$$set({elem_id:e}),w()}get elem_classes(){return this.$$.ctx[1]}set elem_classes(e){this.$$set({elem_classes:e}),w()}get visible(){return this.$$.ctx[2]}set visible(e){this.$$set({visible:e}),w()}get value(){return this.$$.ctx[23]}set value(e){this.$$set({value:e}),w()}get gradio(){return this.$$.ctx[3]}set gradio(e){this.$$set({gradio:e}),w()}get label(){return this.$$.ctx[4]}set label(e){this.$$set({label:e}),w()}get show_label(){return this.$$.ctx[5]}set show_label(e){this.$$set({show_label:e}),w()}get show_legend(){return this.$$.ctx[6]}set show_legend(e){this.$$set({show_legend:e}),w()}get height(){return this.$$.ctx[7]}set height(e){this.$$set({height:e}),w()}get width(){return this.$$.ctx[8]}set width(e){this.$$set({width:e}),w()}get color_map(){return this.$$.ctx[9]}set color_map(e){this.$$set({color_map:e}),w()}get container(){return this.$$.ctx[10]}set container(e){this.$$set({container:e}),w()}get scale(){return this.$$.ctx[11]}set scale(e){this.$$set({scale:e}),w()}get min_width(){return this.$$.ctx[12]}set min_width(e){this.$$set({min_width:e}),w()}get loading_status(){return this.$$.ctx[13]}set loading_status(e){this.$$set({loading_status:e}),w()}get show_fullscreen_button(){return this.$$.ctx[14]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),w()}}export{$e as default};
//# sourceMappingURL=Index-Cm1bR6UF.js.map
